# コラム4（パネルデータと固定効果：差の差の分析法準備） {#causation4}

これまでは、ランダム化比較試験（RCT）や操作変数法という、ランダム化された実験構造を取り入れた調査方法およびデータの活用を前提とした因果効果の分析を紹介してきた。しかしながらマーケティングおよび企業経営においてRCTを行うことが現実的ではない状況も多く存在する。例えば本節で紹介する研究では、Chief Marketing Officer の有無が企業成果に与える影響を分析している。しかしながら、このような研究者の目的のために、実在する複数の企業を用いてRCTを行う（ランダムにCMOを配置する企業を選び、それ以外には配置しない）ことは現実的ではない。

このように実験を行うことが現実的ではない状況において研究者はアクセス可能なデータや変数、分析手法を用いてできるだけバイアスを回避した結果を求める。本節では、そのような分析手法を理解するための準備として、パネルデータ分析における固定効果モデルを紹介する。固定効果モデルでは、時間で変化しない（データ上の時間を通じて一貫した）観測個体の特徴によって生じる被説明変数の変化をコントロールしたうえで分析を行うことができる。固定効果のコントロール自体、マーケティング領域で広く使われている。本節ではまず、いくつかのデータ構造の種類を紹介した後、固定効果モデルの概要を説明する。その後、研究紹介として Germann et al. (2015) による研究成果を整理する。

## データのタイプ
本書で扱う分析手法は、ある特定の時点における複数の観測を捉えたデータセットに対する分析であった。このようなデータは横断面（クロスセクション）データと呼ばれ、\@ref(regintro) 節 で使用したような、特定年度における複数企業の財務データ（例、`firmdata19`）がその代表例である。そしてこのようなデータは以下のような構造を持っている。各企業が特定の年度（2019年）における観測をひとつずつ有している。

```{r crosssection, echo=FALSE, warning=FALSE,message=FALSE}
firmdata <- readxl::read_xlsx("data/MktRes_firmdata.xlsx")
library(tidyverse)

firmdata19 <- firmdata %>% 
  filter(fyear == 2019) %>% 
  select(legalname, fyear,sales, sga, net_profit)
knitr::kable(head(firmdata19), caption = "クロスセクションデータ例")
```

一方で特定の対象を複数の時点にわたって観測することも可能である。このようなデータはパネルデータと呼ばれる。例えば、時系列データの例として株式会社オリエンタルランドの財務情報を2010年度から2019年度まで観察すると、以下のような構造で示すことができる。
```{r timeseries, echo=FALSE, warning=FALSE,message=FALSE}

firmdata_oriental <- firmdata %>% 
  filter(legalname == "株式会社オリエンタルランド") %>% 
  select(legalname, fyear,sales, sga, net_profit)
knitr::kable(head(firmdata_oriental), caption = "時系列データ例")
```

上記のクロスセクションと時系列両方の側面を持つデータをパネルデータと呼ぶ。つまり、複数の対象に対して複数時点の観測を有するデータである。本書で取り込んだ`firmdata`はもともと、複数年度にわたる複数企業の情報を有したパネルデータである。パネルデータは以下のような構造を持つ。

```{r panel, echo=FALSE, warning=FALSE,message=FALSE}
years <- c(2010, 2011, 2012)
firmdata_panel <- firmdata %>% 
  filter(fyear %in% years ) %>% 
  select(legalname, fyear,sales, sga, net_profit)
knitr::kable(head(firmdata_panel, n = 10), caption = "パネルデータ例")
```

パネルデータは各対象に関する異なる年次の観測を、行を増やす形で縦長に構成する。このようなデータの形式をlong型（\@ref(handling)章参照）と呼び、分析においてはlong型のデータを用いる。ここでは、回帰分析における欠落変数問題を回避しうる方法としてパネルデータ分析について紹介する。

## パネルデータ分析と固定効果

パネルデータにおける線形回帰モデルは以下のように示される（任意の$k$個の説明変数を含むモデルに拡張可能である）。
$$
Y_{it}=\beta_0+\beta_1X_{1it}+u_{it}
$$
ただし、$Y_{it}$ は観測（個人や企業）$i$（$i=1,...,N$）、時点 $t$（$t=1,..,T$）の被説明変数、$X_{1it}$ は観測 $i$、時点 $t$ の説明変数を表す。このようなパネルデータに基づく回帰モデルが利用可能な場合、変数を追加することなく欠落変数バイアスに対応することができる。具体的には、固定効果モデルという方法によって、時間で変化しない観測対象固有の特徴については追加的に変数を観測することなく、回帰分析上でコントロールすることができる。

例えば、自社顧客1,000人の購買行動に関する月次データを1年分持っている場合、合計で12,000観測（個人-月）のデータを得たことになる。このとき、顧客個人の価値観のような情報も購買行動に影響を与えうるため、欠落変数バイアスの可能性が存在する。価値観のような情報は心理尺度を利用したアンケート結果と接合しなければ観察は難しく、顧客の購買行動に紐づいたパネルデータとの接合は容易ではない。しかしながら、個人の根本的な価値観が1年間では変化しないと考えられるのであれば、パネルデータを利用した分析によって価値観による欠落変数バイアスを避けることができる。ただし、価値観が時間不変の個人特性であるという点については、理論的・現実的観点から議論する必要がある。また、パネルデータの固定効果モデル分析によって回避できる欠落変数バイアスは時間不変の個人（観測個体）特性についてのみである。

上記のような観測個体に対して時間を通じて一定な（しかし観察できない）変数を固定効果（fixed effects）と呼ぶ。固定効果モデルは以下のように示すことができる。

$$
Y_{it}=\mu_i+\beta_1X_{1it}+u_{it}
$$

このモデルには、$\mu_i$ という項が入っている。この項には $i$ という添字のみが入っており、観測個体ごとに異なるが、時間を通じて一定であることが示されている。この項には被説明変数に影響を与える時間不変の要素がまとめて含まれており、先述の価値観もその他の（$Y_{it}$に影響を与える）時間不変の個人特性もこの中に含まれている。

続いて、固定効果を用いたモデルの推定量（固定効果推定量）の求め方とその解釈について説明する。固定効果モデルの推定では、固定効果を除去したモデルに変換したうえで、そのモデルをOLS推定する（西山ほか, 2019）。モデルの変換においては、被説明変数、説明変数と誤差項について観測個体ごとの平均を取る。例えば、被説明変数であれば$\bar{Y_i}=\sum^T_{t=1}\frac{Y_{it}}{T}$となる。同様に、$\bar{X_i}$ と $\bar{u_i}$ を得る。この個体ごとの平均値を元の回帰モデルから引くことで以下のような固定効果変換後のモデルを得る。

$$
Y_{it}-\bar{Y_i}=\beta_1X_{1it}-\bar{X_i}+u_{it}-\bar{u_i}
$$

固定効果モデルに基づく分析では、このような着目する変数の持つ変動のうち、時間を通じて変化する変動のみを捉えた形（つまり、時間不変の固定効果は除去した形）で回帰モデルを推定することになる。

なお、固定効果推定量については、各観測個体に対するダミー変数を用いた別の解釈と計算方法も存在するが、上記の固定効果変換のものと数学的には同値であることが知られている（Wooldridge, 2013）。例えば、観測個体 1 であれば 1 をとり、それ以外なら 0 を取るようなダミー変数（$D^1_i$）を作成する。同様のダミー変数を全ての観測個体に対応する形で作成し、モデルに含むことで、いかのようなダミー変数回帰モデルを得る。

$$
Y_{it}=\mu_1D^1_i+\mu_2D^2_i+...+\mu_ND^N_i+\beta_1X_{1it}+u_{it}
$$

この場合、各個体ごとに（それぞれのダミー変数に対応する形で）定数項がモデルに含まれる様になる。そして、このダミー変数回帰モデルによって推定されたOLS推定量は先述の固定効果推定量と等しくなることが知られている。

また、研究の実践では、個体の固定効果に加え、時間固定効果の両方を含むモデルを用いた分析も活用されている。この場合、全ての観察個体に共通している個体不変であり観察できないものの、被説明変数に影響を与える変数について時間固定効果としてコントロールすることが可能になる。例えば、経済や社会的なマクロトレンドなどの全ての観測個体に共通すると考えられる時系列変化による影響は、このモデルによってコントロールが可能になる。二方向の固定効果を含む回帰モデルは以下のように示すことができる。


$$
Y_{it}=\mu_i+\lambda_t+\beta_1X_{1it}+u_{it}
$$

このとき、$\lambda_t$ が時間固定効果を表している。このような定式化を用いることで個体固定効果と時間固定効果の両方に関する欠落変数バイアスを（それが観察できないものであっても）回避できるという特性を持っている。

パネルデータ推定についての議論において、変量効果（Random effects）モデルというモデルも存在する。変量効果モデルは、固定効果と同様、$\mu_i$ という時間不変の個人レベルの要素を含むモデルである。しかし変量効果モデルは、この $\mu_i$ がモデル内の説明変数とは無相関であるという仮定を満たす場合のモデルである。言い換えると、$\mu_i$ が説明変数と無相関であるという性質を満たす場合、この効果は変量効果と呼ばれる。固定効果か変量効果かを判別するために統計的な分析を用いる方法が歴史的に採用されてきた。しかしながら、固定効果推定量は、固定効果と変量効果いずれの場合にも一致性を満たすことが知られている。さらに、変量効果と固定効果を判別するための統計的な分析手順に対する問題も提起されている（西山ほか, 2019）。そのため、多くの場合固定効果を用いて分析されており、変量効果を用いるのは時間を通じて不変な要素が研究上重要な説明変数である場合である。そのような場合に固定効果モデルを採用すると、着目している変数の影響が固定効果に吸収されてしまう。つまり、研究上の問いから固定効果モデルが不適切である場合には、変量効果モデルを採用せざるを得ない。

## Chief Marketing Officerの影響に関する分析
「企業の取締役会に最高マーケティング責任者（Chief Marketing Officer: CMO）は必要か？」という問いは、2000年代後半から2010年代にかけて広く議論が展開されてきた。これは、企業経営という広範な視点から見た際のマーケティングの重要性につながる重要な問いである。

CMOの存在が企業成果や価値につながる理由としては、（1）組織にてマーケティング的視点の影響力が強まることで企業レベルの基幹ビジネスプロセスと顧客の価値の創造・維持とを結びつけることにつながることや、（2）そのような意図や特徴を持っていることを市場へ伝えるシグナルとして機能する、と考えられた。しかしながら先行研究ではCMOの存在が企業価値（トービンのQ）へ与える影響については相反する結果が混在していた。特にNath and Mahajan (2008) は、CMOの存在による有意な効果が確認できなかった研究成果として非常に注目を集めた。

このような研究背景に対してGermann et al. (2015) は方法論の観点から先行研究の課題克服を試みた。具体的には、以下の三点からNath and Mahajan (2008) の拡張を試みた：

1. 時間軸：
  - 先行研究では、5年間のデータを使っていたが、CMOの効果より長期的な視点で観察すべきかもしれない。
  - Germann et al. (2018) では、先行研究の情報も内包する12年間のデータを収集した。

2. 産業（サンプルサイズ）：
  - 先行研究では除外されていたいくつかの産業を追加したより網羅的なデータセットの作成した。
  
3. 分析モデル：
  - 先行研究では、Between-effects モデルと呼ばれる、各個体の時間を通じた平均値を用いた回帰モデルを推定していた。この方法では、パネルデータ構造を利用した推定方法を活かせていない。
  - Germann et al. (2015) では、Between-effects モデルに加え、固定効果を含む様々な推定手法を用いた。
  
Germann et al. (2015) は、様々な推定方法についての解説も含む内容で構成されており、教育的な貢献も含まれる論文だと言える。その中でGermannでは、観察できない変数による効果を含むモデルとして固定効果モデルが紹介されている。その他にも、操作変数法（\@ref(causation3)）やランダム効果モデルに加え、ダイナミックパネルモデルを用いた一般化積率法（Generalized Method of Moment: GMM）も行っている。この方法は、モデルに被説明変数（$y_{it}$）のラグ項（$y_{it-1}$）を含むようなモデル化を行い、その特定化によって生じるバイアスについて、被説明変数と内生変数のラグ項を操作変数として用いつつGMMにより推定することで対応しようというものである（Germann et al., 2015）。

分析の結果、分析手法やデータセットによってCMOの有無が成果に与える影響が異なって推定されることが示された。より具体的には、先行研究で用いられたBetween-effectsでは全ての条件において有意な結果は確認できなかった。これは、各企業の時間を通じた平均値を計算することで、各企業内で生じた変化による影響を排除してしまうためではないかと考えられる。一方で、Nath and Mahajan (2008) と異なるデータセット（時間軸、サンプルサイズ）の場合、Between-effects を除く全ての推定方法でCMOによる有意に正の効果が確認された。また、Nath and Mahajan (2008)と同じ条件のデータセットを用いた分析でも、操作変数を含むような推定方法であればCMOによる有意な影響が確認された。しかしながら、このデータセットでは固定効果推定による有意な影響は確認されなかった。これは、CMOの存在が内生変数であることを示唆している。ダイナミックパネルによる効果の確認に加え、「同業他社におけるCMOの普及率」という操作変数（ピアプレッシャーを通じてCMOが配置されるというメカニズムを考慮している）の採用によってもCMOの効果は検出されている。

これらの結果を探索することによって得た実務的・学術的貢献は以下のものである。実務的貢献として、CMOの存在が企業価値に与える正の影響は（特定の推定方法やデータの取り方を除いて）頑健であり、CMOを活用している企業のトービンのQ値はそうでない企業に比べておおよそ15%高いことが示された。これは、企業経営におけるCMOの価値を示す重要な知見の一つであると言える。学術的貢献として、CMOに関わる概念的議論と手法の両面から示すことができる。この研究では、CMOの効果を検証したことに加え、CMOの存在が内生変数である（外生的とは言えない）ことも分析から示している。企業は何らかの理由に基づき、CMOを配置するか否かを判断していることになる。そのため、内生性に対応した分析においてはCMOの効果をより正確に検証できていることが伺える。そのうえで、同業他社からの影響を受けてCMOを配置するというメカニズムに基づくモデルも検証している。これらの知見は、CMOを巡るメカニズムと整合的な分析手法を考えるための学術的示唆として重要な知見である。

多くのCMO、ひいてはマーケティング部門の方々が取締役会や企業経営の視座における自身の価値についてアピールすることに苦労しているかもしれない。学術領域においても、マーケティングとファイナンスの接合点に着目し、マーケティングの価値を確認する研究が積極的に行われている（例えば、Mizik, 2010）。Germann et l. (2015) はこの研究成果を通じて、企業がCMOを取締役会に配置する意義を示す知見としてマーケティング実務家の存在感を高めることにつながることを期待していた。

## 参考文献

西山慶彦・新谷元嗣・川口大司・奥井亮（2019）「計量経済学」，有斐閣.

Germann, F., Ebbes, P., & Grewal, R. (2015). The Chief Marketing Officer Matters! *Journal of Marketing*, 79(3), 1-22.

Mizik, N. (2010). The Theory and Practice of Myopic Management. *Journal of Marketing Research*, 47(4), 594-611.

Nath, P., & Mahajan, V. (2008). Chief Marketing Offi-
cers: A Study of Their Presence in Firms’ Top Management
Teams. *Journal of Marketing*, 72 (January), 65–81.

